<section class="detail" *ngIf="entry; else notFound" aria-live="polite">
  <div class="detail-header">
    <span class="year">{{ entry.year }}</span>
    <h2>{{ entry.name }}</h2>
    <p>{{ entry.shortDescription }}</p>
  </div>

  <div class="detail-body">
    <aside class="detail-portrait-wrap">
      <button
        class="image-button"
        type="button"
        (click)="openImage(entry.image, entry.name, undefined, entry.name)"
      >
        <img class="detail-portrait" [src]="entry.image" [alt]="entry.name" />
      </button>
    </aside>
    <div class="detail-text">
      @for (paragraph of entry.paragraphs; track paragraph; let i = $index) {
        <p [innerHTML]="paragraph"></p>
      }
    </div>
    @if (entry.editorialImage) {
      <figure class="editorial-cutout">
        <button
          class="image-button"
          type="button"
          (click)="
            openImage(
              entry.editorialImage.url,
              entry.editorialImage.caption,
              entry.editorialImage.credit
            )
          "
        >
          <img [src]="entry.editorialImage.url" [alt]="entry.editorialImage.caption" />
        </button>
        <figcaption>
          {{ entry.editorialImage.caption }}
          @if (entry.editorialImage.credit) {
            <span class="credit">Fuente: {{ entry.editorialImage.credit }}</span>
          }
        </figcaption>
      </figure>
    }
    @if (entry.editorialGallery?.length) {
      <div class="editorial-gallery">
        @for (item of entry.editorialGallery; track item.url) {
          <figure>
            <button
              class="image-button"
              type="button"
              (click)="openImage(item.url, item.caption, item.credit)"
            >
              <img [src]="item.url" [alt]="item.caption" />
            </button>
            <figcaption>
              {{ item.caption }}
              @if (item.credit) {
                <span class="credit">Fuente: {{ item.credit }}</span>
              }
            </figcaption>
          </figure>
        }
      </div>
    }
  </div>

  <div
    class="image-lightbox"
    *ngIf="selectedImage"
    (click)="closeImage()"
    (keydown.escape)="closeImage()"
    tabindex="0"
  >
    <figure class="image-lightbox-content" (click)="$event.stopPropagation()">
      <button class="image-lightbox-close" type="button" (click)="closeImage()">
        Cerrar
      </button>
      <img [src]="selectedImage.url" [alt]="selectedImage.alt" />
      @if (selectedImage.caption || selectedImage.credit) {
        <figcaption>
          {{ selectedImage.caption }}
          @if (selectedImage.credit) {
            <span class="credit">Fuente: {{ selectedImage.credit }}</span>
          }
        </figcaption>
      }
    </figure>
  </div>

  <div class="detail-sources" *ngIf="entry.sources.length">
    <h3>Fuentes</h3>
    <ul>
      @for (source of entry.sources; track source.url) {
        <li>
          <a [href]="source.url" target="_blank" rel="noopener">{{ source.label }}</a>
        </li>
      }
    </ul>
  </div>
</section>

<ng-template #notFound>
  <section class="detail">
    <h2>Detalle no encontrado</h2>
    <p>No existe una entrada para este presidente.</p>
  </section>
</ng-template>
